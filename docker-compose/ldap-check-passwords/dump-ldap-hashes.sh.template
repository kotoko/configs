#!/bin/bash
ldapsearch -D 'cn=admin,dc=example,dc=com' -w 'XXX_PLACEHOLDER_PASSWORD_XXX' -H 'ldap://ldap.example.com:389' -b 'ou=users,dc=example,dc=com' dn userPassword mail | sed -n '/dn:/,/^$/p' | tr -d '[:space:]' | sed -e 's#userPassword::#\nuserPassword::#g' -e 's#dn:#\n\ndn:#g' -e 's#mail:#\nmail:#g' | grep -v '^dn:ou=users,dc=example,dc=com$' | sed -e '1,3 {/^$/d}'
